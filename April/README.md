**项目构建日程**

```
2-29 第一天
1.搭建起Server端和Client端 实现 Client 提交表单数据到 Server 端
2.编写Bean层的实体模型
3.自上而下 先完成controller层的编写 然后 完成需要的 Service接口 再去写Service的实现类  然后写数据的持久层
4.完成AES的加密解密 完成RSA的加密解密 签名验签 (AES的密钥是写死的)
今日份总结：
maven不熟悉 在解决依赖时 走了弯路
Ajax 大部分都已经遗忘
对于AES RAS完全不熟悉 以及 对IO文件流操作的不熟悉
附加：晚上加上了derby嵌入 做了数据库连接的封装 测试了插入语句 属性有些多
connect 'jdbc:derby:EmbeddedDB;create=true';
CREATE TABLE filematainfo(
    id INTEGER NOT NULL GENERATED BYDEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) primary key,
    uuid VARCHAR(1024) NOT NULL,
    name VARCHAR(1024) NOT NULL,
    size INTEGER NOT NULL,
    type VARCHAR(32) NOT NULL,
    createtime DATE NOT NULL,
    savefileaddr VARCHAR(1024) NOT NULL,
    fileencrypt VARCHAR(1024) NOT NULL,
);

3-1第二天
鼓捣了2个小时的数据库 后来发现 客户端的功能只需要 上传 展示 下载 
所以逻辑可以很做到更为简单 持久层只需要做插入就行了 要求4才是说要求展示所有信息

AES是加密文件
RSA是加密密钥 生成 信封
感觉快要结束了 哪怕没有接到offer 这次的题目 倒也让自己知道 自己的基本功有多差劲了 
继续努力

3-2第三天
哎呀 糊涂蛋 把题目理解错了 
client 和 server是要做 服务器间通信的 
user将 请求 发送到 client  再由client 去访问 server
不过 反正server端的接口都写好了 1.上传 2.下载 3.校验 4.获取文件元数据信息
有个 client 去跨域请求 再做处理 数据更好渲染到 用户浏览器界面
不过 将前端的样式是做好了 谁叫我是颜值优先呢 应用了 bootstrap fileinput插件 真是 优秀啊 ！

3-3第四天
user -> fileClient <---http---> fileServer
是两个服务器间通信
然后应用了 Spring 的 restTemplate
好了项目已经完备 开始重构不必要的代码 加上更准确的注释

3-4第五天
test类没有写 因为不会 用Junit 编写单元测试
开始了解 泛微 和 契约锁

```

**项目构建中遇到的问题**

1.当在同一个项目下 同时开启 server和 client时 会出现 无法启动的情况

```
解决：开一个maven的父工程April 然后分别配置依赖
```

2.maven 子模块无法 继承 springboot 父工程

```xml
解决：
<dependencyManagement>
    <dependencies>
        <dependency>
            <!-- Import dependency management from Spring Boot -->
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>1.5.7.RELEASE</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
    </dependencyManagement>
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
			<version>1.5.7.RELEASE</version>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```
3.spring-boot-maven-plugin插件无法解析
解决：

```xml
在settings.xml 的 <profiles></profiles>中添加 以下
<pluginRepositories>  
      <pluginRepository>  
        <id>spring plugins</id>  
        <name>Spring plugins</name>  
        <url>https://maven.aliyun.com/repository/spring-plugin</url>  
        <layout>default</layout>  
        <snapshotPolicy>always</snapshotPolicy>  
      </pluginRepository>  
</pluginRepositories>
```

4.thymeleaf 解析html template时失败

```
css/js/img等直接放在resources/static文件夹下，页面放在resources/templates下
并在html中加入<html xmlns:th="http://www.thymeleaf.org"> 变成模板
```

5.springboot static 文件获取不到

```java
解决：需要配置如下的静态资源映射才能直接把static/当成根路径访问
@EnableAutoConfiguration 会启用自动配置类 WebMvcAutoConfiguration
或者自己写
@Configuration
public class WebMvcConfig extends WebMvcConfigurerAdapter {
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        //配置静态资源处理
        registry.addResourceHandler("/static/**")
                .addResourceLocations("classpath:/resources/", "classpath:/static/");
    }
}
```

6.跨域问题

```
先在磁盘上新建一个文件夹eg:  C:\MyChromeDevUserData
 --disable-web-security --user-data-dir=C:\MyChromeDevUserData 
再在chrome的快捷方式的属性中 在目标 后面追加 上面这条 再重新打开谷歌浏览器
```

7.UUID

```java
java.util.UUID.randomUUID().toString().replaceAll("-","");
```

8.RSA非对称加密算法 

```
公钥在server 私钥在client
公钥加密、私钥解密、私钥签名、公钥验签
```

8-2.AES对称加密算法

```
密钥key 就是类似现实生活中的钥匙 用钥匙去锁门 再用钥匙去开门
```

8-3项目加密流程

```
随机的钥匙key

AES (key,file) ->加密后的文件 FILE
RSA(公钥,key) -> 加密后的钥匙 并保存再数据库中 叫做 fileEncrpt
RSA(私钥 ，fileEncrpt) -> 解密钥匙 可以理解为 还原 key
AES(key,FILE) -> 解密文件 file

8-4项目验证流程
client随机生成SID
RSA(私钥，SID)->签名 signature
RSA(公钥，signature)->验签

一般来说RSA算法 是客户端生成钥匙对 然后将公钥发给服务器
```



9.获取resource下的文件路径

```java
src/main/resources/文件名称
this.getClass().getClassLoader().getResource("rsa_pub").getPath();
```

10.Try-with-resources are not supported at language level '5'

```xml
在pom文件中加入下面语句
<build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>8</source>
                    <target>8</target>
                </configuration>
            </plugin>
        </plugins>
</build>
```

11.Controller层向前端传值

```html
controller下弄个这个
Model model
model.addAttribute("X_SID",X_SID);
然后前端接收
Namespace 'th' is not bound  
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
法一：
<input id="websocketUrl" type="hidden" th:value="${websocketUrl}" />
$("#websocketUrl").val();
法二：
<script th:inline="javascript">
/*<![CDATA[*/
    var message = [[${message}]];
    console.log(message);
/*]]>*/
</script>
```

12.将带有 , 的字符串删掉 ， 并存为byte数组 这样才不会改变签名数组

```java
public  byte[] getByte(String str){
int wn = 0;
for(int i = 0; i < str.length(); i++){
	if(str.charAt(i) == ','){wn++;}
}
wn++;
byte[] reByte = new byte[wn];
for(int i = 0; i < wn; i++){
	if( i != (wn - 1)){//16是代表16进制 默认10进制
		reByte[i] = (byte) Integer.valueOf(str.substring(0, str.indexOf(",")), 16).intValue();
		str = str.substring(str.indexOf(",") + 1, str.length());
	}else{
		reByte[i] = (byte) Integer.valueOf(str, 16).intValue();
	}
}
return reByte;
}
```

13.将css 以及js等文件导入到idea中 有时会提示找不到资源 

```
解决：重启idea
```

14jq给指定id赋值

```js
$("#uuid")[0].innerHTML = "123"; 需要 加[0]变成原始对象
```


